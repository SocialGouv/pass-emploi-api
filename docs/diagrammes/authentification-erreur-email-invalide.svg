<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="951px" preserveAspectRatio="none" style="width:1008px;height:951px;background:#FFFFFF;" version="1.1" viewBox="0 0 1008 951" width="1008px" zoomAndPan="magnify"><defs><filter height="300%" id="fgwy7845e1e35" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="559" x="221" y="43.3486">Erreur d'email sur la Première Connexion du Jeune Milo au CEJ</text><rect fill="#FFFFFF" filter="url(#fgwy7845e1e35)" height="267.3281" style="stroke:#000000;stroke-width:2.0;" width="886" x="10" y="224.2891"/><rect fill="#FFFFFF" filter="url(#fgwy7845e1e35)" height="275.4609" style="stroke:#000000;stroke-width:2.0;" width="824" x="167" y="575.0156"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="281" x2="281" y1="137.8906" y2="867.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="477" x2="477" y1="137.8906" y2="867.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="722.5" x2="722.5" y1="137.8906" y2="867.4766"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="819.5" x2="819.5" y1="137.8906" y2="867.4766"/><rect fill="#CBC3E3" filter="url(#fgwy7845e1e35)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="114" x="222" y="102.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="229" y="122.5889">Keycloak i-Milo</text><rect fill="#CBC3E3" filter="url(#fgwy7845e1e35)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="114" x="222" y="866.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100" x="229" y="886.4717">Keycloak i-Milo</text><rect fill="#ADD8E6" filter="url(#fgwy7845e1e35)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="36" x="457" y="102.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="464" y="122.5889">CEJ</text><rect fill="#ADD8E6" filter="url(#fgwy7845e1e35)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="36" x="457" y="866.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="464" y="886.4717">CEJ</text><rect fill="#ADD8E6" filter="url(#fgwy7845e1e35)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="101" x="670.5" y="102.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="677.5" y="122.5889">Keycloak CEJ</text><rect fill="#ADD8E6" filter="url(#fgwy7845e1e35)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="101" x="670.5" y="866.4766"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="677.5" y="886.4717">Keycloak CEJ</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="785.5" y="134.5889">Jeune ML</text><ellipse cx="819.5" cy="64.5938" fill="#FEFECE" filter="url(#fgwy7845e1e35)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M819.5,72.5938 L819.5,99.5938 M806.5,80.5938 L832.5,80.5938 M819.5,99.5938 L806.5,114.5938 M819.5,99.5938 L832.5,114.5938 " fill="none" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="785.5" y="879.4717">Jeune ML</text><ellipse cx="819.5" cy="892.7734" fill="#FEFECE" filter="url(#fgwy7845e1e35)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M819.5,900.7734 L819.5,927.7734 M806.5,908.7734 L832.5,908.7734 M819.5,927.7734 L806.5,942.7734 M819.5,927.7734 L832.5,942.7734 " fill="none" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:2.0;"/><path d="M319,152.8906 L319,207.8906 L630,207.8906 L630,162.8906 L620,152.8906 L319,152.8906 " fill="#FBFB77" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M620,152.8906 L620,162.8906 L630,162.8906 L620,152.8906 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="250" x="325" y="169.9575">Le conseiller a créé le compte du Jeune</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290" x="325" y="185.0903">avec un premier email. Celui-ci est enregistré</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116" x="325" y="200.2231">en BDD sur le CEJ.</text><path d="M10,224.2891 L266,224.2891 L266,231.2891 L256,241.2891 L10,241.2891 L10,224.2891 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="267.3281" style="stroke:#000000;stroke-width:2.0;" width="886" x="10" y="224.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="211" x="25" y="237.356">Première connexion normale</text><polygon fill="#A80036" points="488,258.5547,478,262.5547,488,266.5547,484,262.5547" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="482" x2="818.5" y1="262.5547" y2="262.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="514.25" y="257.4888">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="527.25" y="257.4888">Demande de connexion sur l'application</text><polygon fill="#A80036" points="292,287.6875,282,291.6875,292,295.6875,288,291.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286" x2="476" y1="291.6875" y2="291.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="306.5" y="286.6216">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="319.5" y="286.6216">Redirection SSO Milo</text><polygon fill="#A80036" points="292,316.8203,282,320.8203,292,324.8203,288,320.8203" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286" x2="818.5" y1="320.8203" y2="320.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="498.75" y="315.7544">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="511.75" y="315.7544">ID + MDP Milo</text><polygon fill="#A80036" points="711,366.0859,721,370.0859,711,374.0859,715,370.0859" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="281" x2="717" y1="370.0859" y2="370.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="360" y="357.4536">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="428" y="349.8872">Authentification SSO Milo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="373" y="365.02">Nouvelle session keycloak CEJ : infos Jeune</text><path d="M20,333.8203 L20,373.8203 L272,373.8203 L272,343.8203 L262,333.8203 L20,333.8203 " fill="#FBFB77" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M262,333.8203 L262,343.8203 L272,343.8203 L262,333.8203 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="26" y="350.8872">Ici, les infos Jeune envoyées sont les</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159" x="26" y="366.02">dernières à jour de i-milo</text><polygon fill="#A80036" points="488,412.7852,478,416.7852,488,420.7852,484,416.7852" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="482" x2="722" y1="416.7852" y2="416.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="502.5" y="411.7192">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="515.5" y="411.7192">Authent OK : infos utilisateur</text><path d="M237,388.0859 L237,428.0859 L468,428.0859 L468,398.0859 L458,388.0859 L237,388.0859 " fill="#FBFB77" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M458,388.0859 L458,398.0859 L468,398.0859 L458,388.0859 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="206" x="243" y="405.1528">On crée l'utilisateur sur keycloak</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210" x="243" y="420.2856">ici lors de la première connexion.</text><line style="stroke:#A80036;stroke-width:1.0;" x1="477" x2="519" y1="464.5508" y2="464.5508"/><line style="stroke:#A80036;stroke-width:1.0;" x1="519" x2="519" y1="464.5508" y2="477.5508"/><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="519" y1="477.5508" y2="477.5508"/><polygon fill="#A80036" points="488,473.5508,478,477.5508,488,481.5508,484,477.5508" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="484" y="459.4849">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="497" y="459.4849">Get Jeune by Email</text><path d="M629,442.3516 L629,482.3516 L877,482.3516 L877,452.3516 L867,442.3516 L629,442.3516 " fill="#FBFB77" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M867,442.3516 L867,452.3516 L877,452.3516 L867,442.3516 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227" x="635" y="459.4185">On retrouve le jeune grâce à l'email</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171" x="635" y="474.5513">renseigné par le conseiller.</text><path d="M251,503.6172 L251,558.6172 L699,558.6172 L699,513.6172 L689,503.6172 L251,503.6172 " fill="#FBFB77" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M689,503.6172 L689,513.6172 L699,513.6172 L689,503.6172 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="427" x="257" y="520.6841">Supposons maintenant que le jeune ne s'est pas encore connecté.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301" x="257" y="535.8169">Le conseiller modifie l'email du Jeune sur i-milo.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="353" x="257" y="550.9497">La modification n'est pas répercutée sur la BDD du CEJ.</text><path d="M167,575.0156 L393,575.0156 L393,582.0156 L383,592.0156 L167,592.0156 L167,575.0156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="275.4609" style="stroke:#000000;stroke-width:2.0;" width="824" x="167" y="575.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="181" x="182" y="588.0825">Reproduction de l'erreur</text><polygon fill="#A80036" points="488,609.2813,478,613.2813,488,617.2813,484,613.2813" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="482" x2="818.5" y1="613.2813" y2="613.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="500.75" y="608.2153">bis 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="540.75" y="608.2153">Demande de connexion sur l'application</text><polygon fill="#A80036" points="292,638.4141,282,642.4141,292,646.4141,288,642.4141" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286" x2="476" y1="642.4141" y2="642.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="293" y="637.3481">bis 2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132" x="333" y="637.3481">Redirection SSO Milo</text><polygon fill="#A80036" points="292,667.5469,282,671.5469,292,675.5469,288,671.5469" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="286" x2="818.5" y1="671.5469" y2="671.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="485.25" y="666.481">bis 3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90" x="525.25" y="666.481">ID + MDP Milo</text><polygon fill="#A80036" points="711,711.8125,721,715.8125,711,719.8125,715,715.8125" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="281" x2="717" y1="715.8125" y2="715.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="346.5" y="703.1802">bis 4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="161" x="441.5" y="695.6138">Authentification SSO Milo</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="386.5" y="710.7466">Nouvelle session keycloak CEJ : infos Jeune</text><polygon fill="#A80036" points="488,761.0781,478,765.0781,488,769.0781,484,765.0781" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="482" x2="722" y1="765.0781" y2="765.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="489" y="760.0122">bis 5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="529" y="760.0122">Authent OK : infos utilisateur</text><path d="M177,728.8125 L177,783.8125 L468,783.8125 L468,738.8125 L458,728.8125 L177,728.8125 " fill="#FFCCCB" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M458,728.8125 L458,738.8125 L468,738.8125 L458,728.8125 " fill="#FFCCCB" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267" x="183" y="745.8794">Bien que l'on ait récupéré le nouvel email,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270" x="183" y="761.0122">nous ne répercutons pas les modifications</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="183" y="776.145">pour une première connexion.</text><line style="stroke:#A80036;stroke-width:1.0;" x1="477" x2="519" y1="829.4766" y2="829.4766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="519" x2="519" y1="829.4766" y2="842.4766"/><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="519" y1="842.4766" y2="842.4766"/><polygon fill="#A80036" points="488,838.4766,478,842.4766,488,846.4766,484,842.4766" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="484" y="816.8442">bis 6</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120" x="524" y="809.2778">Get Jeune by Email</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="528" y="824.4106"/><path d="M656,799.7109 L656,839.7109 L972,839.7109 L972,809.7109 L962,799.7109 L656,799.7109 " fill="#FFCCCB" filter="url(#fgwy7845e1e35)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M962,799.7109 L962,809.7109 L972,809.7109 L962,799.7109 " fill="#FFCCCB" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="295" x="662" y="816.7778">L'ancien email  en BDD CEJ ne correspond pas</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="662" y="831.9106">à l'email retourné par i-milo.</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="64" x="937" y="14.2822">Page Header</text><!--MD5=[9c41c1d912e0361bc86ee941f46da836]
@startuml

skinparam backgroundColor white

participant "Keycloak i-Milo" as kckMilo 	#CBC3E3
participant "CEJ" as cej #ADD8E6
participant "Keycloak CEJ" as kckCej #ADD8E6
actor "Jeune ML" as jeune

header Page Header

title Erreur d'email sur la Première Connexion du Jeune Milo au CEJ

autonumber

note over cej  : Le conseiller a créé le compte du Jeune\navec un premier email. Celui-ci est enregistré\nen BDD sur le CEJ.

group Première connexion normale
skinparam sequenceMessageAlign center
jeune -> cej : Demande de connexion sur l'application
cej -> kckMilo : Redirection SSO Milo
jeune -> kckMilo : ID + MDP Milo
kckMilo -> kckCej : Authentification SSO Milo\nNouvelle session keycloak CEJ : infos Jeune
note left : Ici, les infos Jeune envoyées sont les\ndernières à jour de i-milo
kckCej -> cej : Authent OK : infos utilisateur
note left : On crée l'utilisateur sur keycloak\nici lors de la première connexion.
cej -> cej : Get Jeune by Email
note right : On retrouve le jeune grâce à l'email\nrenseigné par le conseiller.
end

autonumber stop
note over cej : Supposons maintenant que le jeune ne s'est pas encore connecté.\nLe conseiller modifie l'email du Jeune sur i-milo.\nLa modification n'est pas répercutée sur la BDD du CEJ.

autonumber "<b>bis "
group Reproduction de l'erreur
skinparam sequenceMessageAlign center
jeune -> cej : Demande de connexion sur l'application
cej -> kckMilo : Redirection SSO Milo
jeune -> kckMilo : ID + MDP Milo
kckMilo -> kckCej : Authentification SSO Milo\nNouvelle session keycloak CEJ : infos Jeune
kckCej -> cej : Authent OK : infos utilisateur
note left #ffcccb : Bien que l'on ait récupéré le nouvel email,\nnous ne répercutons pas les modifications\npour une première connexion.
cej -> cej : <color:red>Get Jeune by Email\n
note right #ffcccb : L'ancien email  en BDD CEJ ne correspond pas\nà l'email retourné par i-milo.

end
@enduml

PlantUML version 1.2021.11(Sat Oct 02 13:26:11 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>