<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="718px" preserveAspectRatio="none" style="width:965px;height:718px;background:#FFFFFF;" version="1.1" viewBox="0 0 965 718" width="965px" zoomAndPan="magnify"><defs><filter height="300%" id="f1grb84y38dd5t" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="354" x="302" y="43.3486">Flux d'authentification pour un Jeune PE</text><rect fill="#FFFFFF" filter="url(#f1grb84y38dd5t)" height="118.6641" style="stroke:#000000;stroke-width:2.0;" width="570" x="114" y="154.8906"/><rect fill="#FFFFFF" filter="url(#f1grb84y38dd5t)" height="260.3281" style="stroke:#000000;stroke-width:2.0;" width="939" x="9" y="356.9531"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="172" x2="172" y1="137.8906" y2="634.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="280" x2="280" y1="137.8906" y2="634.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="480" x2="480" y1="137.8906" y2="634.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="715.5" x2="715.5" y1="137.8906" y2="634.2813"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="811.5" x2="811.5" y1="137.8906" y2="634.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="124" y="134.5889">Conseiller PE</text><ellipse cx="172" cy="64.5938" fill="#FEFECE" filter="url(#f1grb84y38dd5t)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M172,72.5938 L172,99.5938 M159,80.5938 L185,80.5938 M172,99.5938 L159,114.5938 M172,99.5938 L185,114.5938 " fill="none" filter="url(#f1grb84y38dd5t)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="90" x="124" y="646.2764">Conseiller PE</text><ellipse cx="172" cy="659.5781" fill="#FEFECE" filter="url(#f1grb84y38dd5t)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M172,667.5781 L172,694.5781 M159,675.5781 L185,675.5781 M172,694.5781 L159,709.5781 M172,694.5781 L185,709.5781 " fill="none" filter="url(#f1grb84y38dd5t)" style="stroke:#A80036;stroke-width:2.0;"/><rect fill="#CBC3E3" filter="url(#f1grb84y38dd5t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="97" x="230" y="102.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="237" y="122.5889">Keycloak PE</text><rect fill="#CBC3E3" filter="url(#f1grb84y38dd5t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="97" x="230" y="633.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="237" y="653.2764">Keycloak PE</text><rect fill="#ADD8E6" filter="url(#f1grb84y38dd5t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="36" x="460" y="102.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="467" y="122.5889">CEJ</text><rect fill="#ADD8E6" filter="url(#f1grb84y38dd5t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="36" x="460" y="633.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="467" y="653.2764">CEJ</text><rect fill="#ADD8E6" filter="url(#f1grb84y38dd5t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="101" x="663.5" y="102.5938"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="670.5" y="122.5889">Keycloak CEJ</text><rect fill="#ADD8E6" filter="url(#f1grb84y38dd5t)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="101" x="663.5" y="633.2813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="670.5" y="653.2764">Keycloak CEJ</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="778.5" y="134.5889">Jeune PE</text><ellipse cx="812" cy="64.5938" fill="#FEFECE" filter="url(#f1grb84y38dd5t)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M812,72.5938 L812,99.5938 M799,80.5938 L825,80.5938 M812,99.5938 L799,114.5938 M812,99.5938 L825,114.5938 " fill="none" filter="url(#f1grb84y38dd5t)" style="stroke:#A80036;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="778.5" y="646.2764">Jeune PE</text><ellipse cx="812" cy="659.5781" fill="#FEFECE" filter="url(#f1grb84y38dd5t)" rx="8" ry="8" style="stroke:#A80036;stroke-width:2.0;"/><path d="M812,667.5781 L812,694.5781 M799,675.5781 L825,675.5781 M812,694.5781 L799,709.5781 M812,694.5781 L825,709.5781 " fill="none" filter="url(#f1grb84y38dd5t)" style="stroke:#A80036;stroke-width:2.0;"/><path d="M114,154.8906 L388,154.8906 L388,161.8906 L378,171.8906 L114,171.8906 L114,154.8906 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="118.6641" style="stroke:#000000;stroke-width:2.0;" width="570" x="114" y="154.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="229" x="129" y="167.9575">Création du Jeune PE sur le CEJ</text><polygon fill="#A80036" points="468,189.1563,478,193.1563,468,197.1563,472,193.1563" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="172" x2="474" y1="193.1563" y2="193.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="184" y="188.0903">1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="271" x="197" y="188.0903">Création du compte CEJ Jeune : infos Jeune</text><line style="stroke:#A80036;stroke-width:1.0;" x1="480" x2="522" y1="252.5547" y2="252.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="522" x2="522" y1="252.5547" y2="265.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="481" x2="522" y1="265.5547" y2="265.5547"/><polygon fill="#A80036" points="491,261.5547,481,265.5547,491,269.5547,487,265.5547" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="487" y="232.356">2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72" x="500" y="217.2231">Check BDD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="500" y="232.356">Jeune (email) non existant</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168" x="504" y="247.4888">Enregistrement BDD si OK</text><path d="M651,285.5547 L651,340.5547 L873,340.5547 L873,295.5547 L863,285.5547 L651,285.5547 " fill="#FBFB77" filter="url(#f1grb84y38dd5t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M863,285.5547 L863,295.5547 L873,295.5547 L863,285.5547 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="199" x="657" y="302.6216">À ce stade, le compte du jeune</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="657" y="317.7544">est inactif. Il est activé à l'étape</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58" x="657" y="332.8872">suivante.</text><path d="M9,356.9531 L273,356.9531 L273,363.9531 L263,373.9531 L9,373.9531 L9,356.9531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="260.3281" style="stroke:#000000;stroke-width:2.0;" width="939" x="9" y="356.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="219" x="24" y="370.02">Connexion du Jeune sur le CEJ</text><polygon fill="#A80036" points="491,391.2188,481,395.2188,491,399.2188,487,395.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="485" x2="811" y1="395.2188" y2="395.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="512" y="390.1528">3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="525" y="390.1528">Demande de connexion sur l'application</text><polygon fill="#A80036" points="291.5,420.3516,281.5,424.3516,291.5,428.3516,287.5,424.3516" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="285.5" x2="479" y1="424.3516" y2="424.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="312.25" y="419.2856">4</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="325.25" y="419.2856">Redirection SSO PE</text><polygon fill="#A80036" points="291.5,449.4844,281.5,453.4844,291.5,457.4844,287.5,453.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="285.5" x2="811" y1="453.4844" y2="453.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="488.25" y="448.4185">5</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103" x="501.25" y="448.4185">Email + MDP PE</text><polygon fill="#A80036" points="704,498.75,714,502.75,704,506.75,708,502.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="280.5" x2="710" y1="502.75" y2="502.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="316.25" y="490.1177">6</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="428.75" y="482.5513">Authentification SSO PE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351" x="329.25" y="497.6841">Nouvelle session keycloak CEJ : infos Jeune + idAuth PE</text><path d="M19,466.4844 L19,506.4844 L271,506.4844 L271,476.4844 L261,466.4844 L19,466.4844 " fill="#FBFB77" filter="url(#f1grb84y38dd5t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M261,466.4844 L261,476.4844 L271,476.4844 L261,466.4844 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231" x="25" y="483.5513">Ici, les infos Jeune envoyées sont les</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="25" y="498.6841">dernières à jour de PE.</text><polygon fill="#A80036" points="491,532.8828,481,536.8828,491,540.8828,487,536.8828" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="485" x2="715" y1="536.8828" y2="536.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="500.5" y="531.8169">7</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="513.5" y="531.8169">Authent OK : infos utilisateur</text><line style="stroke:#A80036;stroke-width:1.0;" x1="480" x2="522" y1="596.2813" y2="596.2813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="522" x2="522" y1="596.2813" y2="609.2813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="481" x2="522" y1="609.2813" y2="609.2813"/><polygon fill="#A80036" points="491,605.2813,481,609.2813,491,613.2813,487,609.2813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="9" x="487" y="576.0825">8</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126" x="500" y="560.9497">Get Jeune by idAuth</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209" x="500" y="576.0825">(by email si première connexion)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173" x="500" y="591.2153">Update infos Jeune en BDD</text><path d="M721,558.9492 L721,598.9492 L929,598.9492 L929,568.9492 L919,558.9492 L721,558.9492 " fill="#FBFB77" filter="url(#f1grb84y38dd5t)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M919,558.9492 L919,568.9492 L929,568.9492 L919,558.9492 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174" x="727" y="576.0161">On synchronise les infos PE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="727" y="591.1489">avec nos infos Jeune en BDD.</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="64" x="894" y="14.2822">Page Header</text><!--MD5=[e33d4d6e1fa7e76ab62e6cf5c3f25670]
@startuml authentification-flux-pe

skinparam backgroundColor white

actor "Conseiller PE" as conseiller
participant "Keycloak PE" as kckPE 	#CBC3E3
participant "CEJ" as cej #ADD8E6
participant "Keycloak CEJ" as kckCej #ADD8E6
actor "Jeune PE" as jeune

header Page Header

title Flux d'authentification pour un Jeune PE

autonumber
group Création du Jeune PE sur le CEJ
skinparam sequenceMessageAlign right
conseiller -> cej : Création du compte CEJ Jeune : infos Jeune
skinparam sequenceMessageAlign left
cej -> cej : Check BDD\nJeune (email) non existant\n Enregistrement BDD si OK
end

note over kckCej, jeune : À ce stade, le compte du jeune\nest inactif. Il est activé à l'étape\nsuivante.

group Connexion du Jeune sur le CEJ
skinparam sequenceMessageAlign center
jeune -> cej : Demande de connexion sur l'application
cej -> kckPE : Redirection SSO PE
jeune -> kckPE : Email + MDP PE
kckPE -> kckCej : Authentification SSO PE\nNouvelle session keycloak CEJ : infos Jeune + idAuth PE
note left : Ici, les infos Jeune envoyées sont les\ndernières à jour de PE.
kckCej -> cej : Authent OK : infos utilisateur
cej -> cej : Get Jeune by idAuth \n(by email si première connexion)\nUpdate infos Jeune en BDD
note right : On synchronise les infos PE\navec nos infos Jeune en BDD.

end
@enduml

PlantUML version 1.2021.11(Sat Oct 02 13:26:11 GMT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>